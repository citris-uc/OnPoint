<link type="text/css" rel="stylesheet" href="css/settingsMedSchedStyle.css"/>

<!-- Template for popup TODO: move somewhere else? -->
<script id="medSched-popup-template.html" type="text/ng-template">
  <input type="text" ng-model="newSlotName.text" placeholder="Time Slot e.g. Noon">
  <p ng-if="showError"><font color="red">Please enter a name</font></p>
  <br>
  <div>Enter time for new time slot</div>
  <div class="list">

    <label class="item item-input item-select">
      <div class="input-label">
        Hour
      </div>
      <select ng-model="newSlotName.hour">
        <option selected>1</option>
        <option>2</option>
        <option>3</option>
        <option>4</option>
        <option>5</option>
        <option>6</option>
        <option>7</option>
        <option>8</option>
        <option>9</option>
        <option>10</option>
        <option>11</option>
        <option>12</option>
      </select>
    </label>
    <label class="item item-input item-select">
      <div class="input-label">
        Minute
      </div>
      <select ng-model="newSlotName.minute">
        <option selected>00</option>
        <option>15</option>
        <option>30</option>
        <option>45</option>
      </select>
    </label>
    <label class="item item-input item-select">
      <div class="input-label">
        AM/PM
      </div>
      <select ng-model="newSlotName.morning">
        <option selected>AM</option>
        <option>PM</option>
      </select>
    </label>
  </div>
</script>

<ion-view title="Medications Schedule" class="medsched">
  <ion-nav-buttons side="right">
    <button class="button button-clear button-positive"
            ng-click="saveMedicationSchedule()">Save</button>
  </ion-nav-buttons>
  <ion-content overflow-scroll="true" padding="false" class="has-header">
    <!-- <div class="tabs tabs-striped tabs-color-assertive tabs-top"> -->
      <!-- <a class="tab-item"><i class="icon ion-ios-arrow-left"></i></a> -->
      <!-- <a class="tab-item " ng-repeat = "day in week"> -->
        <!-- {{day}} -->
      <!-- </a> -->
      <!-- <a class="tab-item"><i class="icon ion-ios-arrow-right"></i></a> -->
    <!-- </div> -->
      <div class = "item item-icon-right">
        <button id="schedule-add" style="float:right"
                class="button button-clear button-small ion-ios-plus-empty button-positive"
                ng-click="addTimeSlot()"> Add Time Slot</button>
      </div>

    <!-- The dnd-draggable directive makes an element draggable and will
         transfer the object that was assigned to it. If an element was
         dragged away, you have to remove it from the original list
         yourself using the dnd-moved attribute -->
         <!-- dnd-type="'timeSlotType'"
         dnd-draggable="dateSchedule"
         dnd-moved="schedule.splice($index, 1)"
         dnd-effect-allowed="move" -->

    <ul dnd-list="schedule"
        dnd-allowed-types="['timeSlotType']"
        >
        <li class = "card item"
            ng-repeat="dateSchedule in schedule"
            >
            <a>{{dateSchedule.slot | uppercase}}</a>
            <a style="float:right">{{dateSchedule.time | date: 'h:mm a'}}</a>
            <ul dnd-list="dateSchedule.medications"
                dnd-horizontal-list="true"
                dnd-allowed-types="['medType']"
                dnd-drop="dropCallback(event, index, item, external, type, 'itemType',
                                        dateSchedule, dateSchedule.medications == null)"
                >
                <li ng-repeat="med in dateSchedule.medications"
                    dnd_type="'medType'"
                    dnd-draggable="med"
                    dnd-moved="dateSchedule.medications.splice($index, 1)"
                    dnd-effect-allowed="move"
                    >
                    {{med}}
                </li>
            </ul>

        </li>
    </ul>

    <!-- TODO: Connect this to the Fill Medbox page -->
    <div class="padding">
      <button id="medSched-next" class="button button-positive button-block" ng-click="saveMedicationSchedule()">Save and Continue</button>
    </div>
  </ion-content>
</ion-view>
